# 提交订单页面优化说明

## 优化内容

### 1. 票价显示优化
- **问题**: 前端固定显示553元票价，没有使用后端返回的真实票价
- **解决方案**: 
  - 修改前端代码，使用后端返回的真实票价数据
  - 从`response.carriages`中获取每个席别的真实票价
  - 动态显示不同席别的不同票价

### 2. 乘客信息显示优化
- **问题**: 选中乘客后显示乘客类型，用户更关心手机号
- **解决方案**:
  - 将乘客类型显示改为手机号显示
  - 添加`passengerPhoneMap`状态来存储乘客手机号
  - 在乘客列表中显示手机号而不是乘客类型
  - 在表格中将"乘客类型"列改为"手机号"列

### 3. 温馨提示内容优化
- **问题**: 温馨提示包含了票种选择规则，信息过于复杂
- **解决方案**:
  - 移除票种选择规则说明
  - 保留实用的出行提示信息
  - 简化提示内容，提高用户体验

## 技术实现

### 后端API响应结构
```json
{
  "trainInfo": {
    "trainNumber": "G101",
    "departureStation": "北京南",
    "arrivalStation": "上海虹桥",
    "departureTime": "09:00:00",
    "arrivalTime": "14:30:00",
    "travelDate": "2025-07-08"
  },
  "carriages": [
    {
      "inventoryId": 1,
      "carriageTypeName": "商务座",
      "price": 553.00,
      "hasStock": true,
      "availableStock": 10
    },
    {
      "inventoryId": 2,
      "carriageTypeName": "一等座", 
      "price": 553.00,
      "hasStock": true,
      "availableStock": 20
    },
    {
      "inventoryId": 3,
      "carriageTypeName": "二等座",
      "price": 553.00,
      "hasStock": false,
      "availableStock": 0
    }
  ],
  "passengers": [
    {
      "passengerId": 1,
      "realName": "张三",
      "idCardNumber": "110101199001011234",
      "phoneNumber": "13800138000",
      "passengerType": 1,
      "passengerTypeName": "成人",
      "relationType": 1,
      "relationTypeName": "本人"
    }
  ]
}
```

### 前端状态管理
```javascript
const [passengerPhoneMap, setPassengerPhoneMap] = useState({});
const [response, setResponse] = useState(null);
```

### 票价显示逻辑
```javascript
{response && response.carriages && response.carriages.map((carriage, index) => (
    <span key={index} className="ticket-item ticket-available" style={{ marginRight: '20px' }}>
        <span className="seat-type">{carriage.carriageTypeName}</span>
        （<span className="price price-available">¥{carriage.price}元</span>） 有票
    </span>
))}
```

### 手机号显示逻辑
```javascript
<span className="passenger-phone">{passengerPhoneMap[name]}</span>
```

## 样式优化

### 新增CSS样式
```css
.passenger-phone {
    color: #666;
    font-size: 12px;
    margin-left: 8px;
}

.tips-section {
    margin-top: 20px;
    padding: 15px;
    background-color: #f8f9fa;
    border-radius: 6px;
    border-left: 4px solid #1890ff;
}

.tips-title {
    font-weight: bold;
    color: #1890ff;
    margin-bottom: 10px;
    font-size: 14px;
}

.tips-content {
    color: #666;
    font-size: 12px;
    line-height: 1.6;
}
```

## 测试要点

### 1. 票价显示测试
- [ ] 验证不同席别显示不同票价
- [ ] 验证票价数据来自后端API
- [ ] 验证票价格式正确（¥xxx元）

### 2. 乘客信息显示测试
- [ ] 验证乘客列表中显示手机号
- [ ] 验证表格中"手机号"列显示正确
- [ ] 验证手机号格式正确

### 3. 温馨提示测试
- [ ] 验证移除了票种选择规则
- [ ] 验证保留了实用的出行提示
- [ ] 验证提示样式美观

### 4. 整体功能测试
- [ ] 验证页面加载正常
- [ ] 验证乘客选择功能正常
- [ ] 验证票种选择限制正常
- [ ] 验证表单提交功能正常

## 注意事项

1. **数据依赖**: 需要确保后端API返回正确的票价和乘客信息
2. **样式兼容**: 新增的CSS样式需要与现有样式协调
3. **用户体验**: 手机号显示比乘客类型更实用
4. **信息简化**: 温馨提示内容更加简洁实用

## 后续优化建议

1. **动态席别**: 可以根据库存情况动态显示可选的席别
2. **价格计算**: 可以根据票种类型动态计算优惠价格
3. **信息验证**: 可以添加手机号格式验证
4. **交互优化**: 可以添加更多的用户交互反馈 