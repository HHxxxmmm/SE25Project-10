# 票种限制功能测试

## 功能概述

票种限制功能确保乘客只能购买符合其身份的票种，这是铁路购票系统的重要业务规则。

## 票种选择规则

### 乘客类型与票种对应关系
| 乘客类型 | 可购买票种 | 说明 |
|---------|-----------|------|
| 成人（1） | 成人票 | 只能购买成人票 |
| 儿童（2） | 儿童票 | 只能购买儿童票 |
| 学生（3） | 成人票、学生票 | 可以购买成人票或学生票 |
| 残疾（4） | 成人票、残疾票 | 可以购买成人票或残疾票 |
| 军人（5） | 成人票、军人票 | 可以购买成人票或军人票 |

### 票种价格优惠
| 票种 | 价格优惠 | 说明 |
|------|---------|------|
| 成人票 | 全价 | 无优惠 |
| 儿童票 | 5折 | 半价优惠 |
| 学生票 | 7.5折 | 学生优惠 |
| 残疾票 | 免费 | 全额免费 |
| 军人票 | 免费 | 全额免费 |

## 测试用例

### 1. 成人乘客测试
**测试目标**: 验证成人乘客只能购买成人票

**测试步骤**:
1. 访问提交订单页面
2. 选择成人类型的乘客
3. 查看票种选择框

**预期结果**:
- 票种选择框只显示"成人票"
- 无法选择其他票种
- 默认选中"成人票"

### 2. 儿童乘客测试
**测试目标**: 验证儿童乘客只能购买儿童票

**测试步骤**:
1. 访问提交订单页面
2. 选择儿童类型的乘客
3. 查看票种选择框

**预期结果**:
- 票种选择框只显示"儿童票"
- 无法选择其他票种
- 默认选中"儿童票"

### 3. 学生乘客测试
**测试目标**: 验证学生乘客可以购买成人票或学生票

**测试步骤**:
1. 访问提交订单页面
2. 选择学生类型的乘客
3. 查看票种选择框
4. 切换票种选择

**预期结果**:
- 票种选择框显示"成人票"和"学生票"
- 可以在这两种票种间切换
- 默认选中"成人票"

### 4. 残疾乘客测试
**测试目标**: 验证残疾乘客可以购买成人票或残疾票

**测试步骤**:
1. 访问提交订单页面
2. 选择残疾类型的乘客
3. 查看票种选择框
4. 切换票种选择

**预期结果**:
- 票种选择框显示"成人票"和"残疾票"
- 可以在这两种票种间切换
- 默认选中"成人票"

### 5. 军人乘客测试
**测试目标**: 验证军人乘客可以购买成人票或军人票

**测试步骤**:
1. 访问提交订单页面
2. 选择军人类型的乘客
3. 查看票种选择框
4. 切换票种选择

**预期结果**:
- 票种选择框显示"成人票"和"军人票"
- 可以在这两种票种间切换
- 默认选中"成人票"

## 界面验证

### 1. 乘客列表显示
- 每个乘客后面应显示乘客类型
- 乘客类型显示格式: "（成人）"、"（学生）"等
- 乘客类型样式为灰色背景的小标签

### 2. 乘客详情表格
- 表格中应包含"乘客类型"列
- 乘客类型列显示乘客的具体类型
- 票种选择框根据乘客类型动态显示选项

### 3. 温馨提示
- 页面底部应显示票种选择规则说明
- 规则说明应包含所有乘客类型的票种限制

## 边界测试

### 1. 未知乘客类型
**测试场景**: 乘客类型不在预定义范围内
**预期结果**: 默认只能购买成人票

### 2. 乘客类型为空
**测试场景**: 乘客类型字段为空或null
**预期结果**: 默认只能购买成人票

### 3. 多个乘客混合
**测试场景**: 同时选择不同类型的乘客
**预期结果**: 每个乘客的票种选择框独立显示对应选项

## 数据验证

### 1. 后端数据验证
- 确保乘客类型数据正确传递到前端
- 验证乘客类型字段的数据类型和取值范围

### 2. 前端数据验证
- 验证乘客类型映射是否正确
- 验证票种限制逻辑是否正确实现

### 3. 用户交互验证
- 验证票种选择框的交互是否流畅
- 验证选择票种后的数据更新是否正确

## 错误处理

### 1. 数据加载失败
- 当无法获取乘客类型信息时，默认显示成人票选项
- 显示适当的错误提示

### 2. 网络异常
- 网络请求失败时，显示错误信息
- 提供重试选项

### 3. 数据格式错误
- 乘客类型数据格式错误时，使用默认值
- 记录错误日志便于调试

## 性能考虑

### 1. 渲染性能
- 票种选择框的动态渲染不应影响页面性能
- 大量乘客时的渲染性能测试

### 2. 内存使用
- 乘客类型映射和票种限制逻辑的内存使用
- 避免内存泄漏

## 兼容性测试

### 1. 浏览器兼容性
- Chrome、Firefox、Safari、Edge
- 移动端浏览器

### 2. 设备兼容性
- 桌面端、平板、手机
- 不同屏幕尺寸的显示效果

## 安全考虑

### 1. 数据验证
- 前端票种限制不能替代后端验证
- 后端必须验证票种选择的合法性

### 2. 权限控制
- 确保用户只能为自己的乘客选择票种
- 防止越权操作

## 测试环境

### 1. 开发环境
- 本地开发服务器
- 测试数据库

### 2. 测试数据
- 包含各种类型乘客的测试数据
- 不同用户关联不同乘客的测试场景

## 测试工具

### 1. 手动测试
- 浏览器开发者工具
- 网络请求监控

### 2. 自动化测试
- 单元测试
- 集成测试
- E2E测试

## 测试报告

### 1. 测试结果记录
- 记录每个测试用例的执行结果
- 记录发现的问题和修复情况

### 2. 性能指标
- 页面加载时间
- 票种选择响应时间
- 内存使用情况

### 3. 问题跟踪
- 记录所有发现的问题
- 跟踪问题修复进度
- 验证修复效果 